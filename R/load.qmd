---
title: "load file"
format: html
editor: visual
---

```{r}
#|echo: false
#|label: load libraries
library(tidyverse)
library(dplyr)
library(readr)
```

```{r}
# Create data directory 

data_dir <- "../data/"
if( !dir.exists(data_dir) ){
  dir.create(path = data_dir)
}

raw_dir <- "../data/_raw/"
if( !dir.exists(raw_dir) ){
  dir.create(path = raw_dir)
}
```

URLS

```{r}
human_file <- "https://raw.githubusercontent.com/s232996/project/main/gCSI_GRdata_v1.3.tsv/data/human.csv"

human_supp_file <- "https://raw.githubusercontent.com/s232996/project/main/gCSI_GRdata_v1.3.tsv/data/human_suppl.txt"

mouse_file <- "https://raw.githubusercontent.com/s232996/project/main/gCSI_GRdata_v1.3.tsv/data/mouse.csv"

mouse_supp_file <- "https://raw.githubusercontent.com/s232996/project/main/gCSI_GRdata_v1.3.tsv/data/mouse_suppl.txt"
```

```{r}
# Download human data set files 

human_file <- "https://raw.githubusercontent.com/s232996/project/main/gCSI_GRdata_v1.3.tsv/data/human.csv"

if( !file.exists(str_c(raw_dir, "human.csv"))){
  download.file(
    url = human_file,
    destfile = str_c(raw_dir, "human.csv"))
}

human_data<-read.csv(str_c(raw_dir, "human.csv"), header = TRUE, sep = ",")

write.csv(human_data, file = "./data/_raw/human.csv.gz")

write.table(human_data, file = file.path(data_dir, "human.tsv"), sep = "\t", row.names = FALSE)
```

```{r}
# Download human supplementary data set files 

human_supp_file <- "https://raw.githubusercontent.com/s232996/project/main/gCSI_GRdata_v1.3.tsv/data/human_suppl.txt"

if( !file.exists(str_c(raw_dir, "human_supp.txt"))){
  download.file(
    url = human_supp_file,
    destfile = str_c(raw_dir, "human_supp.txt"))
}

human_supp_data<-read.table(str_c(raw_dir, "human_supp.txt"), header = TRUE, sep = "\t")

write.table(human_supp_data, file = file.path(data_dir, "human_supp.tsv"), sep = "\t", row.names = FALSE)
```

```{r}
# Download mouse data set files 

mouse_file <- "https://raw.githubusercontent.com/s232996/project/main/gCSI_GRdata_v1.3.tsv/data/mouse.csv"

if( !file.exists(str_c(raw_dir, "mouse.csv"))){
  download.file(
    url = mouse_file,
    destfile = str_c(raw_dir, "mouse.csv"))
}

mouse_data<-read.csv(str_c(raw_dir, "mouse.csv"), header = TRUE, sep = ",")

write.table(mouse_data, file = file.path(data_dir, "mouse.tsv"), sep = "\t", row.names = FALSE)
```

```{r}
# Download mouse supplementary data set files 

mouse_supp_file <- "https://raw.githubusercontent.com/s232996/project/main/gCSI_GRdata_v1.3.tsv/data/mouse_suppl.txt"

if( !file.exists(str_c(raw_dir, "mouse_supp.txt"))){
  download.file(
    url = mouse_supp_file,
    destfile = str_c(raw_dir, "mouse_supp.txt"))
}

mouse_supp_data<-read.table(str_c(raw_dir, "mouse_supp.txt"), header = TRUE, sep = "\t")

write.table(mouse_supp_data, file = file.path(data_dir, "mouse_supp.tsv"), sep = "\t", row.names = FALSE)
```

```{r}
head(human_data)
head(human_sup_data)
head(mouse_data)
head(mouse_sup_data)
```

```{r}
## FUNCTION FOR THE ABOVE

download_and_convert <- function(file_url, file_name, data_dir, raw_dir) {
  # Download file if it doesn't exist
  if (!file.exists(file.path(raw_dir, file_name))) {
    download.file(url = file_url, destfile = file.path(raw_dir, file_name))
  }

  # Read the data into a data frame
  data <- read.csv(str_c(raw_dir, file_name), header = TRUE, sep = ",")

  # Write the data to a TSV file
  write.table(data, file = file.path(data_dir, str_c(file_name, ".tsv")), sep = "/t", row.names = FALSE)
}

# Usage example

download_and_convert(human_file, "human.csv", data_dir, raw_dir)
```
