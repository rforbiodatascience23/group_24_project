---
title: "load file"
format: html
editor: visual
---

```{r}
#|echo: false
#|label: load libraries
#First we have to load the necessary libraries
library(tidyverse)
library(dplyr)
library(readr)
```

Then we can take a first look on the structure of the datasets.

This dataset comes from the study (**Mouse melanoma cell line B16-F10 treated with G007-LK**) in which 12 samples were used. What was measured in that study was the effect of different compounds in the B16-F10 cells. The compounds that were used were the following: dimethyl sulfoxide, WNT3a and GOO7LK (Each of the compound was applied in equal number of samples ie. 3).

This study could be found under the Accession number: E-MTAB-8101

The dataset containing the human cells was generated though the **Human melanoma cell lines treated with G007-LK** study during which 18 human melanoma cell lines derived from the skin of the donors were treated with the compound GOO7-LK with the purpose of detecting its effect to the cells and in order to compare those results with a similar experiment performed on mice cell lines.

In detail the experiment went like so:

Three pooled technical replicates from a panel of 18 human melanoma cell lines were treated with DMSO and G007-LK for 24 hours.

This study could be found under the Accession number: E-MTAB-8438

```{r}

#|label: transform the human raw data
#then we need to load our data and transform them to tsv format



human_raw_csv<-vroom::vroom("../_raw/human_cell_lines_treated.csv",
                        show_col_types = FALSE) 

write.table(human_raw_csv,
            file = "../data/human_raw.tsv",
            sep = "\t",
            row.names = FALSE, 
            quote = FALSE)

human_raw_data<- vroom::vroom("../data/human_raw.tsv", 
                         show_col_types = FALSE)


```

```{r}
#|label: transform the mouse raw data
mouse_raw_csv<-vroom::vroom("../_raw/mouse_cell_lines_treated.csv",
                                show_col_types = FALSE) 
write.table(mouse_raw_csv,
            file = "../data/mouse_raw.tsv",
            sep = "\t",
            row.names = FALSE, 
            quote = FALSE)

mouse_raw_data<- vroom::vroom("../data/mouse_raw.tsv", 
                          show_col_types = FALSE)
```

```{r}
#|label: transform the human supplementary data
human_sup_txt<-vroom::vroom("../_raw/E-MTAB-8438.sdrf.txt",
                        show_col_types = FALSE) 

write.table(human_sup_txt,
            file = "../data/human_sup.tsv",
            sep = "\t",
            row.names = FALSE, 
            quote = FALSE)

human_sup_data<- vroom::vroom("../data/human_sup.tsv",
                              show_col_types = FALSE)
```

```{r}

#|label: transform the mouse supplementary data

mouse_sup_txt<-vroom::vroom("../_raw/E-MTAB-8101.sdrf.txt",
                        show_col_types = FALSE) 

write.table(mouse_sup_txt,
            file = "../data/mouse_sup.tsv",
            sep = "\t",
            row.names = FALSE, 
            quote = FALSE)

mouse_sup_data<- vroom::vroom("../data/mouse_sup.tsv", 
                              show_col_types = FALSE)
```

```{r}
head(human_sup_data)
```

```{r}
#maybe a function for transform our uploading datasets
#but needs improvement
#file_tr <- function(origin,filename){
 # x<-vroom::vroom("../_raw/origin",
 #              show_col_types = FALSE)
#  write.table(x,
    #          file = "../data/filename.tsv",
     #         sep = "\t",
      #        row.names = FALSE, 
       #       quote = FALSE)
  
  #filename<- vroom::vroom("../data/filename.tsv", 
   #                       show_col_types = FALSE)
  
#}
```

```{r}
#Load the human and mouse supplementary files

raw_dir <- "../_raw/"
human_sup_file <- "E-MTAB-8438.sdrf.txt"
human_sup_loc <- "https://ftp.ebi.ac.uk/biostudies/nfs/E-MTAB-/438/E-MTAB-8438/Files/"

write.table(human_sup_file, file = "mouse_sup.tsv", sep = "\t", row.names = FALSE)

# Create the data directory programmatically

if( !dir.exists(raw_dir) ){
  dir.create(path = raw_dir)
}

#download file if it does not exist

if( !file.exists(str_c(raw_dir, human_sup_file)) ){
  download.file(
    url = str_c(human_sup_loc, human_sup_file),
    destfile = str_c(raw_dir, human_sup_file))
  write.table(human_sup_file,
              file = "mouse_sup.tsv",
              sep = "\t",
              row.names = FALSE)

}
#read the data


human_sup_data<-read.table(str_c(raw_dir, human_sup_file), header = TRUE, sep = "\t")


#mouse_data
mouse_sup_file <- "E-MTAB-8101.sdrf.txt"
mouse_sup_loc <- "https://ftp.ebi.ac.uk/biostudies/nfs/E-MTAB-/101/E-MTAB-8101/Files/"

write.table(mouse_sup_file, file = "mouse_sup.tsv", sep = "\t", row.names = FALSE)

# Create the data directory programmatically

if( !dir.exists(raw_dir) ){
  dir.create(path = raw_dir)
}

if( !file.exists(str_c(raw_dir, mouse_sup_file)) ){
  download.file(
    url = str_c(mouse_sup_loc, mouse_sup_file),
    destfile = str_c(raw_dir, mouse_sup_file))
}


#create the tsv files inside the _raw folder

write.table(human_sup_data, file = file.path(raw_dir, "human_sup.tsv"), sep = "/t", row.names = FALSE)
write.table(mouse_sup_data, file = file.path(raw_dir, "mouse_sup.tsv"), sep = "/t", row.names = FALSE)
```
