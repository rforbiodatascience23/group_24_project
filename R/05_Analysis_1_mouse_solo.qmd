---
title: "Analysis 1 file - Isolated analysis of the mouse dataset"
format: html
editor: visual
---

```{r}
#|label: load the packages
#|install.packages("VennDiagram")
library(VennDiagram)
library(tidyverse)
library(stringr)
library(dplyr)
library(tidyr)
library(broom)
library(ggrepel)
source("../R/99_proj_func.R")
```

This analysis will see which genes are significantly up and down regulated in the treatment trials

Here we begin by loading the augmented mouse dataset

```{r}
Sys.setenv(VROOM_CONNECTION_SIZE = 3062144) # Setting a larger connection buffer to be able to load the data
# Loading the data
mouse_df <- read_tsv(file = "../data/04_dat_aug_mouse.tsv.gz")
```

First we loose the "Factor Value\[compound\]" (concentration) column since we don't need it in this analysis

```{r}
mouse_df = mouse_df |> 
  select(-c(`Factor Value[compound]`))

```

Now lets do an analysis to see which genes are significantly up and down regulated in each of the treatment trials.

```{r}
mouse_G007LK_lm <- generate_lm_genes(mouse_df, 'G007LK')
signif_genes_error_bars(mouse_G007LK_lm)

```

```{r}
volcano_plot(mouse_G007LK_lm)
```

```{r}
mouse_WNT_lm <- generate_lm_genes(mouse_df, 'WNT')
signif_genes_error_bars(mouse_WNT_lm)

```

```{r}
volcano_plot(mouse_WNT_lm)
```

```{r}
mouse_WNTG007LK_lm <- generate_lm_genes(mouse_df, 'WNT_G007LK')
signif_genes_error_bars(mouse_WNTG007LK_lm)

```

```{r}
volcano_plot(mouse_WNTG007LK_lm)
```

```{r}
genes_G007LK <- mouse_G007LK_lm %>% 
  filter(signif) %>%
  pull(Gene)

genes_WNTG007LK <- significant_genes_df %>% 
  filter(Treatment) %>% 
  pull(Gene)

genes_WNT <- significant_genes_df %>% 
  filter(Treatment) %>% 
  pull(Gene)

gene_lists <- list(G007LK = genes_G007LK, WNTG007LK = genes_WNTG007LK, WNT = genes_WNT)

```

```{r}
full_path <- paste(getwd(), "/results/mouse_venn_diagram.png", sep="")
venn.diagram(
  x = gene_lists,
  category.names = c("G007LK", "WNTG007LK", "WNT"),
  filename = full_path,
  output = TRUE
)
```

```{}
```

\
