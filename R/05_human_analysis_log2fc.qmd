---
title: "Untitled"
format: html
editor: visual
---

PCA analysis using the LOG2fold change in the 18 human Cell lines

```{r}
library(tidyverse) 
library(dplyr)
library(broom) # devtools::install_github("tidymodels/broom")
library(ggplot2)
library(cowplot) 
library(purrr)
library(scales)
library(ggrepel)

human_log2fold <- read_tsv(file = "../data/03_dat_aug_human_log2fc.tsv.gz")
```

```{r}
human_log2fold
```

PCA model

```{r}
#| cache: true
pca_result<- human_log2fold |> 
  select_if(is.numeric) |> 
  scale() |> 
  prcomp()
```

This is the plot corresponding the Log2fold change of the cell lines

```{r}
pca_augmented <- pca_result |>
  augment(data = human_log2fold) 
  
pca_augmented |>   
  ggplot(mapping = aes(x =.fittedPC1, 
             y = .fittedPC2, 
             color = cell_line))+
  geom_point(size =2.5) +
    geom_text_repel( 
                  mapping = aes(label = cell_line))+
  background_grid() + 
  labs( x = "PC1(12,7%)", 
        y = "PC2(7.5%)", 
        title = "PCA Plot Depicting Log2foldchange under G007.LK in Human Cells")
```

Rotation matrix

```{r}
pca_result |> 
  tidy(matrix = "rotation")
```

```{r}
pca_result |> 
  tidy(matrix = "eigenvalues")
```

```{r}
pca_result |> 
  tidy(matrix = "eigenvalues") |> 
  ggplot(aes(PC, percent)) + 
  geom_col(fill = "#56B4E9", alpha = 0.8) + 
  scale_x_continuous(breaks = 1:9) + 
  scale_y_continuous( labels = scales::percent_format(), 
                      expand = expansion(mult = c(0, 0.01)) ) + 
  theme_minimal_hgrid(12)
```
